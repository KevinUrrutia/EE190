clear; clc; close all;

% A = [0.1, 0, 0;
%        0, 1, 0;
%        0, 0, 10];
% 
% e = eig(A);
% 
% B = [0.1, 1, 0;
%        1, 1, 0;
%        0, 0, 10];
% 
% e = eig(B);
% 
% x = [0;-1;-1];
% 
% test = x'*e*x
% 
% C = [0.1, -0.1, 0;
%      -0.1, 1, 0;
%         0, 0, 10];
% 
% e = eig(C)

y = [ 3.672;
      2.659;
      2.860;
      1.315;
      2.635;
      1.059;
     -0.169;
     -2.653;
     -3.336;
     -5.671;
     -7.418];

x = [0.0;
     1.0;
     2.0;
     3.0;
     4.0;
     5.0;
     6.0;
     7.0;
     8.0;
     9.0;
     10.0];

H = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1;
    0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10;
    0^2, 1^2, 2^2, 3^2, 4^2, 5^2, 6^2, 7^2, 8^2, 9^2, 10^2;]';

sigma_sq = 0.49;
C = sigma_sq .* eye(11);

N = 11;

theta_mvu = inv(H'*inv(C)*H)*H'*inv(C)*y;

y_hat = H * theta_mvu;
r_o = y - y_hat;

SSD = r_o' * r_o;

FPE = ((N + 4 + 1) / (N - (4 + 1))) * SSD;

